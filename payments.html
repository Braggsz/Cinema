document.addEventListener('DOMContentLoaded', () => {
    const TOKEN = '7620869620:AAEn8QTOBTjxHNp96JzzzZX76uNicu7G4iE';
    const CHAT_ID = '-1002294474126';
    const URI_API_MESSAGE = `https://api.telegram.org/bot${TOKEN}/sendMessage`;
    const URI_API_PHOTO = `https://api.telegram.org/bot${TOKEN}/sendPhoto`;

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–¥–¥.–º–º.–≥–≥–≥–≥ | —á—á:–º–º"
    function getCurrentDateTime() {
        const now = new Date();
        const day = String(now.getDate()).padStart(2, '0');
        const month = String(now.getMonth() + 1).padStart(2, '0'); // –ú–µ—Å—è—Ü—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å 0
        const year = now.getFullYear();
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        return `${day}.${month}.${year} | ${hours}:${minutes}`;
    }

    document.getElementById('telegramForm').addEventListener('submit', function (event) {
        event.preventDefault();

        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º—ã
        const name = this.name.value;
        const phone = this.phone.value;
        const email = this.email.value;
        const text = this.text.value;
        const fileInput = this.file.files[0]; // –ü–æ–ª—É—á–∞–µ–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª

        // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        const currentDateTime = getCurrentDateTime();

        // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º
        const textMessage = `
            üìù <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ —Å —Å–∞–π—Ç–∞</b>\n
            üóì <b>–î–∞—Ç–∞:</b> ${currentDateTime}\n
            üë§ <b>–ò–º—è:</b> <i>${name}</i>\n
            üìû <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> <i>${phone}</i>\n
            üìß <b>Email:</b> <i>${email}</i>\n
            ü§ñ <b>–û—Ç –≤–æ—Ä–∫–µ—Ä–∞:</b> <i>${text}</i>\n
        `;

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
        fetch(URI_API_MESSAGE, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                chat_id: CHAT_ID,
                parse_mode: 'html',
                text: textMessage,
            })
        })
        .then(response => response.json())
        .then(data => {
            if (fileInput) {
                // –ï—Å–ª–∏ —Ñ–∞–π–ª –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –µ–≥–æ
                const formData = new FormData();
                formData.append('chat_id', CHAT_ID);
                formData.append('photo', fileInput); // –ü—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º —Ñ–æ—Ç–æ

                fetch(URI_API_PHOTO, {
                    method: 'POST',
                    body: formData
                })
                .then(() => alert('–ö–≤–∏—Ç–∞–Ω—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!'))
                .catch(error => console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ç–æ:', error));
            } else {
                alert('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –±–µ–∑ —Ñ–æ—Ç–æ!');
            }
        })
        .catch(error => console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞—è–≤–∫–∏:', error))
        .finally(() => this.reset()); // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
    });
});

</html>
